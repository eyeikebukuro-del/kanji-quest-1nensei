:root{font-family:system-ui,Avenir,Helvetica,Arial,sans-serif;line-height:1.5;font-weight:400;color-scheme:light dark;color:#ffffffde;background-color:#242424;font-synthesis:none;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}a{font-weight:500;color:#646cff;text-decoration:inherit}a:hover{color:#535bf2}body{margin:0;display:flex;place-items:center;min-width:320px;min-height:100vh}h1{font-size:3.2em;line-height:1.1}button{border-radius:8px;border:1px solid transparent;padding:.6em 1.2em;font-size:1em;font-weight:500;font-family:inherit;background-color:#1a1a1a;cursor:pointer;transition:border-color .25s}button:hover{border-color:#646cff}button:focus,button:focus-visible{outline:4px auto -webkit-focus-ring-color}@media(prefers-color-scheme:light){:root{color:#213547;background-color:#fff}a:hover{color:#747bff}button{background-color:#f9f9f9}}import React,{useState}from "react"; // ステージIDの型（1-1,1-2,... 5-5） type StageId = `${number}-${number}`; // ワールド一覧 const WORLDS = [{id: 1,name: "1年生のくに（前半）"},{id: 2,name: "いきものの森"},{id: 3,name: "からだ＆きもち"},{id: 4,name: "とき・きせつ"},{id: 5,name: "さいごのとう"},]; const STAGES_PER_WORLD = 5; // 問題データ型 type Question ={id:number;kanji:string;// 問題に出す漢字 reading: string;// 正しい読み choices: string[];// ひらがな4択 hint?: string;// あれば意味のヒント}; // ステージごとの問題一覧 const STAGE_QUESTIONS: Record<StageId,Question[]> ={"1-1": [{id: 1,kanji: "山",reading: "やま",choices: ["やま","かわ","そら","き"],hint: "たかいところ。ふじさんなど。",},{id: 2,kanji: "川",reading: "かわ",choices: ["かわ","みち","うみ","やま"],hint: "みずがながれているところ。",},{id: 3,kanji: "日",reading: "ひ",choices: ["ひ","つち","そら","つき"],hint: "あさにのぼって、よるにしずむもの。",},{id: 4,kanji: "月",reading: "つき",choices: ["つき","やま","かわ","ほし"],hint: "よるのそらにでてくる まるいもの。",},],// 他のステージはのちほど追加 "1-2": [],"1-3": [],"1-4": [],"1-5": [],"2-1": [],"2-2": [],"2-3": [],"2-4": [],"2-5": [],"3-1": [],"3-2": [],"3-3": [],"3-4": [],"3-5": [],"4-1": [],"4-2": [],"4-3": [],"4-4": [],"4-5": [],"5-1": [],"5-2": [],"5-3": [],"5-4": [],"5-5": [],}; type BattleProps ={stageId:StageId;onBackToMap:() => void}; // 漢字バトル画面コンポーネント const KanjiBattle: React.FC<BattleProps> = ({stageId,onBackToMap}) =>{const questions = STAGE_QUESTIONS[stageId] || [];const [currentIndex,setCurrentIndex] = useState(0);const [correctCount,setCorrectCount] = useState(0);const [answered,setAnswered] = useState(false);const [isCorrect,setIsCorrect] = useState<boolean | null>(null);const [finished,setFinished] = useState(false);const current = questions[currentIndex];const handleAnswer = (choice: string) =>{if (!current || answered) return;const ok = choice === current.reading;setIsCorrect(ok);setAnswered(true);if (ok){setCorrectCount((c) => c + 1)}}const handleNext = () =>{if (currentIndex + 1 >= questions.length){setFinished(true)}else{setCurrentIndex((i) => i + 1);setAnswered(false);setIsCorrect(null)}}const handleRetry = () =>{setCurrentIndex(0);setCorrectCount(0);setAnswered(false);setIsCorrect(null);setFinished(false)}if (questions.length === 0){return (<div style={cardStyle}> <h2>ステージ {stageId}</h2> <p>このステージは まだじゅんびちゅうだよ。</p> <button style={buttonStyle} onClick={onBackToMap}> マップにもどる </button> </div>)}if (finished){const scorePercent = Math.round((correctCount / questions.length) * 100);return (<div style={cardStyle}> <h2>ステージ {stageId} クリア！</h2> <p> せいかい：{correctCount} / {questions.length}（{scorePercent}%） </p> <p>よくがんばったね！ もういちど ちょうせんしてもいいよ。</p> <div style={{marginTop: 16,display: "flex",gap: 8}}> <button style={buttonStyle} onClick={handleRetry}> もういちど </button> <button style={buttonStyle} onClick={onBackToMap}> マップにもどる </button> </div> </div>)}if (!current){return (<div style={cardStyle}> <p>問題データがありません。</p> <button style={buttonStyle} onClick={onBackToMap}> マップにもどる </button> </div>)}return (<div style={cardStyle}> <h2>ステージ {stageId}</h2> <p> もんだい {currentIndex + 1} / {questions.length} </p> <div style={{marginTop: 16,padding: 16,borderRadius: 12,border: "2px solid #333",textAlign: "center",}} > <div style={{fontSize: "64px",marginBottom: 8}}>{current.kanji}</div> {current.hint && (<div style={{fontSize: "14px",color: "#555"}}> ヒント：{current.hint} </div>)} </div> <div style={{marginTop: 16,display: "grid",gridTemplateColumns: "1fr 1fr",gap: 12,}} > {current.choices.map((choice) => {const isChosenCorrect = answered && choice === current.reading; const isChosenWrong = answered && isCorrect === false && choice !== current.reading; let background = "#fff"; if (isChosenCorrect) background = "#d4f8d4"; if (isChosenWrong) background = "#f8d4d4"; return (<button key={choice} style={{...choiceButtonStyle,background,}} onClick={() => handleAnswer(choice)} disabled={answered} > {choice} </button>);})} </div> {answered && (<div style={{marginTop: 16}}> {isCorrect ? (<p style={{color: "green",fontWeight: "bold"}}> せいかい！ すごい！ </p>) : (<p style={{color: "red",fontWeight: "bold"}}> ざんねん！ せいかいは「{current.reading}」だよ。 </p>)} <button style={buttonStyle} onClick={handleNext}> つぎの もんだいへ </button> </div>)} <button style={{...buttonStyle,marginTop: 16}} onClick={onBackToMap} > マップにもどる </button> </div>)}; // 共通スタイル const appContainerStyle: React.CSSProperties ={fontFamily:"system-ui, -apple-system, BlinkMacSystemFont, sans-serif",padding: 16,maxWidth: 800,margin: "0 auto",}; const cardStyle: React.CSSProperties ={marginTop:16,padding: 16,border: "1px solid #ccc",borderRadius: 12,backgroundColor: "#fff",boxShadow: "0 2px 4px rgba(0,0,0,0.05)",}; const buttonStyle: React.CSSProperties ={padding:"8px 16px",borderRadius: 8,border: "1px solid #888",cursor: "pointer",fontSize: 16,}; const choiceButtonStyle: React.CSSProperties ={padding:"12px 8px",borderRadius: 10,border: "1px solid #888",cursor: "pointer",fontSize: 18,}; // ルートコンポーネント const App: React.FC = () =>{const [currentStage,setCurrentStage] = useState<StageId | null>(null);const handleSelectStage = (worldId: number,stageNo: number) =>{const id = `${worldId}-${stageNo}` as StageId;setCurrentStage(id)}const handleBackToMap = () =>{setCurrentStage(null)}return (<div style={appContainerStyle}> <h1>漢字クエスト 1年生</h1> <p>ステージをえらんで、漢字モンスターとバトルしよう！</p> {!currentStage && (<> {WORLDS.map((world) => (<div key={world.id} style={cardStyle}> <h2> ワールド {world.id}: {world.name} </h2> <div style={{display: "flex",gap: 8,flexWrap: "wrap"}}> {Array.from({length: STAGES_PER_WORLD}).map((_,index) => {const stageNo = index + 1; const stageId = `${world.id}-${stageNo}` as StageId; const hasQuestions = STAGE_QUESTIONS[stageId] && STAGE_QUESTIONS[stageId].length > 0; return (<button key={stageNo} style={{...buttonStyle,opacity: hasQuestions ? 1 : .5,}} onClick={() => hasQuestions && handleSelectStage(world.id,stageNo)} > {world.id}-{stageNo} {!hasQuestions && "（じゅんびちゅう）"} </button>);})} </div> </div>))} </>)} {currentStage && (<KanjiBattle stageId={currentStage} onBackToMap={handleBackToMap} />)} </div>)}; export default App;{}
